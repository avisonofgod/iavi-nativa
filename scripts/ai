#!/bin/bash

if [ -z "$1" ]; then
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘  ğŸ¤– AI Agent - Comando Directo                     â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "Uso: ai \"tu comando aquÃ­\""
    echo ""
    echo "Ejemplos:"
    echo "  ai \"muestra el uso de memoria\""
    echo "  ai \"lista archivos en /root\""
    echo "  ai \"instala nginx y configÃºralo\""
    echo "  ai \"crea un script Python que calcule fibonacci\""
    echo "  ai \"analiza los logs de nginx y muestra errores\""
    echo ""
    exit 0
fi

COMANDO="$*"

python3 -u << EOFPYTHON
from interpreter import interpreter
import sys

interpreter.offline = True
interpreter.auto_run = True
interpreter.llm.model = "ollama/llama3.2:3b"
interpreter.llm.api_base = "http://localhost:11434"
interpreter.llm.temperature = 0.7

print("\nğŸ¤– AI Agent trabajando...\n")

try:
    for chunk in interpreter.chat("${COMANDO}", display=True, stream=True):
        pass
    print("\nâœ… Listo\n")
except KeyboardInterrupt:
    print("\n\nâŒ Cancelado")
    sys.exit(0)
EOFPYTHON
